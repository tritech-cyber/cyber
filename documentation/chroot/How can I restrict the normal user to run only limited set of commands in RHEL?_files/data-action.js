window,define(["jquery","lodash","chrome_lib","nimbus/tour","jsUri"],function(d,l,r,a,c){var m=3e3;function p(){var a=r.store.local.get("dismissedToasts");return a||(r.store.local.set("dismissedToasts",[]),a=r.store.local.get("dismissedToasts")),a}function u(i){var n=i.attr("id");i.find(".btn, button, .close").on("click",function(a){i.removeClass("show");var o,t,s=d(this),e=s.attr("href");new c(e),new c(window.location.href),(s.hasClass("close")||s.hasClass("dismiss")||s.hasClass("done"))&&(a.preventDefault(),"autotoast"===i.attr("data-action")&&(o=n,(t=p()).push(o),r.store.local.set("dismissedToasts",t)),s.hasClass("done")&&e&&(window.location.href=e))})}function f(a){a.addClass("show")}function v(o,t){var s=d("body");o.on("click",function(a){a.preventDefault(),function(a,o){var t=d("body"),s=a.attr("title"),e="",i=!1;if(null!==o.match(/\.(jpeg|jpg|gif|png)/))e='<img src="'+o+'" alt="'+s+'">',i=!0;else{var n=o.match(/youtube\.com\/(watch\?v=|embed\/)(\w*)[\&\?](.*\=.*)/);if(null!=n){var r=a.attr("data-aspect-ratio");null==r&&(r="16:9"),e='<div class="video-wrapper" data-aspect-ratio="'+r+'"><iframe width="560" height="315" src="https://www.youtube.com/embed/'+n[2]+"?"+n[3]+'&rel=0" target="_parent" frameborder="0" allowfullscreen></iframe></div>',i=!0}}i&&(t.addClass("zoom-open"),t.append('<div class="zoom-modal in" tabindex="-1" role="dialog"><div class="zoom-wrap"><button type="button" class="close" aria-hidden="true">Ã—</button><div class="zoom-body">'+e+"</div></div></div>"),t.append('<div class="zoom-backdrop in"></div>'))}(o,t)}),s.on("click",function(a){var o=d(a.target),t=o.attr("class");("close"===t&&o.parent().hasClass("zoom-wrap")||"zoom-modal in"===t||"zoom-backdrop in"===t)&&(d(".zoom-modal, .zoom-backdrop").remove(),s.removeClass("zoom-open"))})}d("[data-action]").each(function(){var a,o,t,s,e,i,n=d(this),r=n.attr("data-action");"toast"===r?(a=d(n.attr("href")),o=a,n.on("click",function(a){a.preventDefault(),f(o)}),u(o)):"autotoast"===r?(t=n,s=p(),e=t.attr("id"),i=t.attr("data-toast-delay")||m,-1===s.indexOf(e)&&l.delay(l.partial(f,t),i),u(t)):"zoom"===r?(href=n.attr("href"),v(n,href)):"modal"===r&&function(){d("[data-cp-modal-target]").on("click",function(a){a.preventDefault();var o=d(d(this).attr("data-cp-modal-target"));o.addClass("in"),o.next(".cp-modal-backdrop").addClass("in")});var s=d("body");s.on("click",function(a){var o=d(a.target),t=o.attr("class");(o.hasClass("cp-modal-close")||"cp-modal in"===t||"cp-modal-backdrop in"===t)&&(d(".cp-modal, .cp-modal-backdrop").removeClass("in"),s.removeClass("cp-modal-open"))})}()})});
//# sourceMappingURL=data-action.js.map