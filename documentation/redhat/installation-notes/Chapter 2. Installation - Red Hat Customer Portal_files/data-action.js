window,define(["jquery","lodash","chrome_lib","nimbus/tour","jsUri"],function(a,t,o,s,e){function n(){var a=o.store.local.get("dismissedToasts");return a||(o.store.local.set("dismissedToasts",[]),a=o.store.local.get("dismissedToasts")),a}function i(a){var t=n();t.push(a),o.store.local.set("dismissedToasts",t)}function r(t){var o=t.attr("id");t.find(".btn, button, .close").on("click",function(s){t.removeClass("show");var n=a(this),r=n.attr("href");new e(r),new e(window.location.href);(n.hasClass("close")||n.hasClass("dismiss")||n.hasClass("done"))&&(s.preventDefault(),"autotoast"===t.attr("data-action")&&i(o),n.hasClass("done")&&r&&(window.location.href=r))})}function d(a,t){a.on("click",function(a){a.preventDefault(),c(t)}),r(t)}function c(a){a.addClass("show")}function l(a){var o=n(),s=a.attr("id"),e=a.attr("data-toast-delay")||h;if(-1===o.indexOf(s))t.delay(t.partial(c,a),e);r(a)}function m(a){return null!==a.match(/\.(jpeg|jpg|gif|png)/)}function u(a){return a.match(/youtube\.com\/(watch\?v=|embed\/)(\w*)[\&\?](.*\=.*)/)}function f(t,o){var s=a("body"),e=t.attr("title"),n="",i=!1;if(m(o))n='<img src="'+o+'" alt="'+e+'">',i=!0;else{var r=u(o);if(null!=r){var d=t.attr("data-aspect-ratio");void 0==d&&(d="16:9"),n='<div class="video-wrapper" data-aspect-ratio="'+d+'"><iframe width="560" height="315" src="'+("https://www.youtube.com/embed/"+r[2]+"?"+r[3]+"&rel=0")+'" target="_parent" frameborder="0" allowfullscreen></iframe></div>',i=!0}}i&&(s.addClass("zoom-open"),s.append('<div class="zoom-modal in" tabindex="-1" role="dialog"><div class="zoom-wrap"><button type="button" class="close" aria-hidden="true">Ã—</button><div class="zoom-body">'+n+"</div></div></div>"),s.append('<div class="zoom-backdrop in"></div>'))}function p(t,o){var s=a("body");t.on("click",function(a){a.preventDefault(),f(t,o)}),s.on("click",function(t){var o=a(t.target),e=o.attr("class");("close"===e&&o.parent().hasClass("zoom-wrap")||"zoom-modal in"===e||"zoom-backdrop in"===e)&&(a(".zoom-modal, .zoom-backdrop").remove(),s.removeClass("zoom-open"))})}function v(){a("[data-cp-modal-target]").on("click",function(t){t.preventDefault();var o=a(a(this).attr("data-cp-modal-target"));o.addClass("in"),o.next(".cp-modal-backdrop").addClass("in")});var t=a("body");t.on("click",function(o){var s=a(o.target),e=s.attr("class");(s.hasClass("cp-modal-close")||"cp-modal in"===e||"cp-modal-backdrop in"===e)&&(a(".cp-modal, .cp-modal-backdrop").removeClass("in"),t.removeClass("cp-modal-open"))})}var h=3e3;a("[data-action]").each(function(){var t=a(this),o=t.attr("data-action");"toast"===o?d(t,a(t.attr("href"))):"autotoast"===o?l(t):"zoom"===o?(href=t.attr("href"),p(t,href)):"modal"===o&&v()})});
//# sourceMappingURL=data-action.js.map